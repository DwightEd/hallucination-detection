[2026-01-21 02:00:16,208][__main__][INFO] - ============================================================
[2026-01-21 02:00:16,208][__main__][INFO] - Train Probe: hsdmvaf
[2026-01-21 02:00:16,208][__main__][INFO] - Dataset: ragtruth
[2026-01-21 02:00:16,208][__main__][INFO] - Model: Llama-2-7b-chat-hf
[2026-01-21 02:00:16,208][__main__][INFO] - Task: QA
[2026-01-21 02:00:16,208][__main__][INFO] - ============================================================
[2026-01-21 02:00:20,281][src.features.loader][INFO] - === First sample feature check ===
[2026-01-21 02:00:20,281][src.features.loader][INFO] -   sample_id: 11858
[2026-01-21 02:00:20,281][src.features.loader][INFO] -   Features matched: ['attn_diags', 'laplacian_diags', 'attn_entropy']
[2026-01-21 02:00:20,281][src.features.loader][INFO] -   hidden_states: lazy-load available
[2026-01-21 02:00:20,289][src.features.loader][INFO] - Loaded 803 samples
[2026-01-21 02:00:20,290][__main__][INFO] - Loaded 803 samples from outputs/features/ragtruth/Llama-2-7b-chat-hf/seed_42/QA
[2026-01-21 02:00:20,290][__main__][INFO] - Train: 803 (347 positive)
[2026-01-21 02:00:20,290][__main__][INFO] - Test:  0 (0 positive)
[2026-01-21 02:00:20,290][__main__][INFO] - 
[2026-01-21 02:00:20,290][__main__][INFO] - ============================================================
[2026-01-21 02:00:20,290][__main__][INFO] - Training at level: sample
[2026-01-21 02:00:20,290][__main__][INFO] - ============================================================
[2026-01-21 02:00:20,290][__main__][INFO] - Training hsdmvaf at sample level...
[2026-01-21 02:00:20,360][src.methods.base][INFO] - Extracting features: 0/803 (0%)
[2026-01-21 02:03:36,793][src.methods.base][INFO] - Extracting features: 80/803 (10%)
/share/home/tm902089733300000/a903202310/lys/research/hallucination-detection/src/methods/hsdmvaf/features.py:98: UserWarning: std(): degrees of freedom is <= 0. Correction should be strictly less than the reduction factor (input numel divided by output numel). (Triggered internally at /pytorch/aten/src/ATen/native/ReduceOps.cpp:1831.)
  std = all_features.std(dim=0, keepdim=True) + 1e-8
[2026-01-21 02:06:57,364][src.methods.base][INFO] - Extracting features: 160/803 (20%)
[2026-01-21 02:10:07,532][src.methods.base][INFO] - Extracting features: 240/803 (30%)
[2026-01-21 02:13:17,467][src.methods.base][INFO] - Extracting features: 320/803 (40%)
[2026-01-21 02:16:24,821][src.methods.base][INFO] - Extracting features: 400/803 (50%)
[2026-01-21 02:19:36,914][src.methods.base][INFO] - Extracting features: 480/803 (60%)
[2026-01-21 02:22:44,801][src.methods.base][INFO] - Extracting features: 560/803 (70%)
[2026-01-21 02:25:04,383][src.methods.base][INFO] - Extracting features: 640/803 (80%)
[2026-01-21 02:28:22,249][src.methods.base][INFO] - Extracting features: 720/803 (90%)
[2026-01-21 02:31:52,711][src.methods.base][INFO] - Extracting features: 800/803 (100%)
[2026-01-21 02:32:02,606][src.methods.base][INFO] - Training on 803 samples, feature dim=12288
/share/home/tm902089733300000/a903202310/lys/research/hallucination-detection/src/methods/hsdmvaf/features.py:98: UserWarning: std(): degrees of freedom is <= 0. Correction should be strictly less than the reduction factor (input numel divided by output numel). (Triggered internally at /pytorch/aten/src/ATen/native/ReduceOps.cpp:1831.)
  std = all_features.std(dim=0, keepdim=True) + 1e-8
/share/home/tm902089733300000/a903202310/lys/research/hallucination-detection/src/methods/hsdmvaf/features.py:98: UserWarning: std(): degrees of freedom is <= 0. Correction should be strictly less than the reduction factor (input numel divided by output numel). (Triggered internally at /pytorch/aten/src/ATen/native/ReduceOps.cpp:1831.)
  std = all_features.std(dim=0, keepdim=True) + 1e-8
[2026-01-21 03:01:59,395][__main__][INFO] - ----------------------------------------
[2026-01-21 03:01:59,395][__main__][INFO] - [sample] Train AUROC: 1.0000
[2026-01-21 03:01:59,395][__main__][INFO] - [sample] Train AUPR:  1.0000
[2026-01-21 03:01:59,395][__main__][INFO] - ----------------------------------------
[2026-01-21 03:01:59,422][src.methods.base][INFO] - Saved method to outputs/models/ragtruth/Llama-2-7b-chat-hf/seed_42/QA/hsdmvaf/sample/model.pkl
[2026-01-21 03:01:59,422][__main__][INFO] - 
[2026-01-21 03:01:59,422][__main__][INFO] - [sample] Performance Metrics:
[2026-01-21 03:01:59,422][__main__][INFO] -   Training Time: 1908.31s
[2026-01-21 03:01:59,422][__main__][INFO] -   Peak CPU Memory: 154.9 MB
[2026-01-21 03:01:59,422][__main__][INFO] -   Peak GPU Memory: 0.0 MB
[2026-01-21 03:01:59,422][__main__][INFO] -   Model Size: 0.38 MB
[2026-01-21 03:01:59,436][__main__][INFO] - [sample] Model saved to: outputs/models/ragtruth/Llama-2-7b-chat-hf/seed_42/QA/hsdmvaf/sample/model.pkl
[2026-01-21 03:01:59,436][__main__][INFO] - [sample] Metrics saved to: outputs/models/ragtruth/Llama-2-7b-chat-hf/seed_42/QA/hsdmvaf/sample/train_metrics.json
[2026-01-21 03:01:59,447][__main__][INFO] - 
[2026-01-21 03:01:59,447][__main__][INFO] - ============================================================
[2026-01-21 03:01:59,447][__main__][INFO] - Training Summary
[2026-01-21 03:01:59,447][__main__][INFO] - ============================================================
[2026-01-21 03:01:59,447][__main__][INFO] -   [sample] AUROC: 1.0000, AUPR: 1.0000
[2026-01-21 03:01:59,447][__main__][INFO] - ============================================================
