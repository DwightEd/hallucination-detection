[2026-01-22 11:52:20,846][__main__][INFO] - ============================================================
[2026-01-22 11:52:20,846][__main__][INFO] - Train Probe: hsdmvaf
[2026-01-22 11:52:20,846][__main__][INFO] - Dataset: ragtruth
[2026-01-22 11:52:20,846][__main__][INFO] - Model: Llama-2-7b-chat-hf
[2026-01-22 11:52:20,846][__main__][INFO] - Task: QA
[2026-01-22 11:52:20,846][__main__][INFO] - ============================================================
[2026-01-22 11:52:27,919][src.features.loader][INFO] - === First sample feature check ===
[2026-01-22 11:52:27,919][src.features.loader][INFO] -   sample_id: 11858
[2026-01-22 11:52:27,919][src.features.loader][INFO] -   Features matched: ['attn_diags', 'laplacian_diags', 'attn_entropy']
[2026-01-22 11:52:27,919][src.features.loader][INFO] -   hidden_states: lazy-load available
[2026-01-22 11:52:27,927][src.features.loader][INFO] - Loaded 803 samples
[2026-01-22 11:52:27,928][__main__][INFO] - Loaded 803 samples from outputs/features/ragtruth/Llama-2-7b-chat-hf/seed_42/QA
[2026-01-22 11:52:27,928][__main__][INFO] - Train: 803 (347 positive)
[2026-01-22 11:52:27,928][__main__][INFO] - Test:  0 (0 positive)
[2026-01-22 11:52:27,928][__main__][INFO] - 
[2026-01-22 11:52:27,928][__main__][INFO] - ============================================================
[2026-01-22 11:52:27,928][__main__][INFO] - Training at level: sample
[2026-01-22 11:52:27,928][__main__][INFO] - ============================================================
[2026-01-22 11:52:27,928][__main__][INFO] - Training hsdmvaf at sample level...
[2026-01-22 11:52:28,013][src.methods.base][INFO] - Extracting features: 0/803 (0%)
[2026-01-22 12:00:07,005][src.methods.base][INFO] - Extracting features: 80/803 (10%)
/share/home/tm902089733300000/a903202310/lys/research/hallucination-detection/src/methods/hsdmvaf/features.py:98: UserWarning: std(): degrees of freedom is <= 0. Correction should be strictly less than the reduction factor (input numel divided by output numel). (Triggered internally at /pytorch/aten/src/ATen/native/ReduceOps.cpp:1831.)
  std = all_features.std(dim=0, keepdim=True) + 1e-8
[2026-01-22 12:08:09,477][src.methods.base][INFO] - Extracting features: 160/803 (20%)
[2026-01-22 12:15:25,239][src.methods.base][INFO] - Extracting features: 240/803 (30%)
[2026-01-22 12:21:57,844][src.methods.base][INFO] - Extracting features: 320/803 (40%)
Traceback (most recent call last):
  File "/share/home/tm902089733300000/a903202310/lys/research/hallucination-detection/scripts/train_probe.py", line 288, in <module>
    main()
  File "/share/home/tm902089733300000/a903202310/lys/conda_envs/lapeigvals/lib/python3.12/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/share/home/tm902089733300000/a903202310/lys/conda_envs/lapeigvals/lib/python3.12/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/share/home/tm902089733300000/a903202310/lys/conda_envs/lapeigvals/lib/python3.12/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/share/home/tm902089733300000/a903202310/lys/conda_envs/lapeigvals/lib/python3.12/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
           ^^^^^^
  File "/share/home/tm902089733300000/a903202310/lys/conda_envs/lapeigvals/lib/python3.12/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
            ^^^^^^^^^^
  File "/share/home/tm902089733300000/a903202310/lys/conda_envs/lapeigvals/lib/python3.12/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
          ^^^^^^^^
  File "/share/home/tm902089733300000/a903202310/lys/conda_envs/lapeigvals/lib/python3.12/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/share/home/tm902089733300000/a903202310/lys/research/hallucination-detection/scripts/train_probe.py", line 264, in main
    success, metrics = train_single_level(
                       ^^^^^^^^^^^^^^^^^^^
  File "/share/home/tm902089733300000/a903202310/lys/research/hallucination-detection/scripts/train_probe.py", line 142, in train_single_level
    fit_metrics = method.fit(train_features, train_labels, cv=False)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/share/home/tm902089733300000/a903202310/lys/research/hallucination-detection/src/methods/base.py", line 122, in fit
    x = self.extract_method_features(feat)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/share/home/tm902089733300000/a903202310/lys/research/hallucination-detection/src/methods/hsdmvaf/method.py", line 55, in extract_method_features
    data['attn_diags'],
^^^^^^^^^^^^^^^^^^^^^^^^
  File "/share/home/tm902089733300000/a903202310/lys/research/hallucination-detection/src/core/types.py", line 344, in release_large_features
    def release_large_features(self) -> None:

KeyboardInterrupt
