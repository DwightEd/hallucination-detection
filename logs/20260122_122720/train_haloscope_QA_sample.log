[2026-01-22 12:45:11,566][__main__][INFO] - ============================================================
[2026-01-22 12:45:11,567][__main__][INFO] - Train Probe: haloscope
[2026-01-22 12:45:11,567][__main__][INFO] - Dataset: ragtruth
[2026-01-22 12:45:11,567][__main__][INFO] - Model: Llama-2-7b-chat-hf
[2026-01-22 12:45:11,567][__main__][INFO] - Task: QA
[2026-01-22 12:45:11,567][__main__][INFO] - ============================================================
[2026-01-22 12:45:18,500][src.features.loader][INFO] - === First sample feature check ===
[2026-01-22 12:45:18,500][src.features.loader][INFO] -   sample_id: 11858
[2026-01-22 12:45:18,500][src.features.loader][INFO] -   Features matched: ['attn_diags', 'laplacian_diags', 'attn_entropy']
[2026-01-22 12:45:18,500][src.features.loader][INFO] -   hidden_states: lazy-load available
[2026-01-22 12:45:18,514][src.features.loader][INFO] - Loaded 803 samples
[2026-01-22 12:45:18,514][__main__][INFO] - Loaded 803 samples from outputs/features/ragtruth/Llama-2-7b-chat-hf/seed_42/QA
[2026-01-22 12:45:18,515][__main__][INFO] - Train: 803 (347 positive)
[2026-01-22 12:45:18,515][__main__][INFO] - Test:  0 (0 positive)
[2026-01-22 12:45:18,515][__main__][INFO] - 
[2026-01-22 12:45:18,515][__main__][INFO] - ============================================================
[2026-01-22 12:45:18,516][__main__][INFO] - Training at level: sample
[2026-01-22 12:45:18,516][__main__][INFO] - ============================================================
[2026-01-22 12:45:18,516][__main__][INFO] - Training haloscope at sample level...
[2026-01-22 12:55:16,376][src.methods.haloscope][INFO] - Fitting HaloScope SVD on 803 samples
[2026-01-22 12:59:47,595][src.methods.haloscope][INFO] - SVD completed, top singular values: [268.18744 252.23581 198.73123 178.25534 151.58669]
[2026-01-22 12:59:47,702][src.methods.haloscope][INFO] - Reference scores: mean=13034.4281, std=15909.5636
[2026-01-22 13:11:31,688][src.methods.haloscope][INFO] - Training MLP on 803 samples, feature dim=32768
[2026-01-22 13:11:33,784][src.methods.haloscope][INFO] - Epoch 10/50, Loss: 0.6446
[2026-01-22 13:11:33,958][src.methods.haloscope][INFO] - Epoch 20/50, Loss: 0.6043
[2026-01-22 13:11:34,134][src.methods.haloscope][INFO] - Epoch 30/50, Loss: 0.5714
[2026-01-22 13:11:34,309][src.methods.haloscope][INFO] - Epoch 40/50, Loss: 0.5547
[2026-01-22 13:11:34,481][src.methods.haloscope][INFO] - Epoch 50/50, Loss: 0.5494
Traceback (most recent call last):
  File "/share/home/tm902089733300000/a903202310/lys/research/hallucination-detection/scripts/train_probe.py", line 288, in <module>
    main()
  File "/share/home/tm902089733300000/a903202310/lys/conda_envs/lapeigvals/lib/python3.12/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/share/home/tm902089733300000/a903202310/lys/conda_envs/lapeigvals/lib/python3.12/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/share/home/tm902089733300000/a903202310/lys/conda_envs/lapeigvals/lib/python3.12/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/share/home/tm902089733300000/a903202310/lys/conda_envs/lapeigvals/lib/python3.12/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
           ^^^^^^
  File "/share/home/tm902089733300000/a903202310/lys/conda_envs/lapeigvals/lib/python3.12/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
            ^^^^^^^^^^
  File "/share/home/tm902089733300000/a903202310/lys/conda_envs/lapeigvals/lib/python3.12/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
          ^^^^^^^^
  File "/share/home/tm902089733300000/a903202310/lys/conda_envs/lapeigvals/lib/python3.12/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/share/home/tm902089733300000/a903202310/lys/research/hallucination-detection/scripts/train_probe.py", line 264, in main
    success, metrics = train_single_level(
                       ^^^^^^^^^^^^^^^^^^^
  File "/share/home/tm902089733300000/a903202310/lys/research/hallucination-detection/scripts/train_probe.py", line 146, in train_single_level
    train_metrics = compute_metrics(method, train_features, train_labels, "train_")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/share/home/tm902089733300000/a903202310/lys/research/hallucination-detection/scripts/train_probe.py", line 58, in compute_metrics
    predictions = method.predict_batch(features)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/share/home/tm902089733300000/a903202310/lys/research/hallucination-detection/src/methods/base.py", line 209, in predict_batch
    pred = self.predict(feat)
           ^^^^^^^^^^^^^^^^^^
  File "/share/home/tm902089733300000/a903202310/lys/research/hallucination-detection/src/methods/haloscope.py", line 754, in predict
    x = self.extract_method_features(features)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/share/home/tm902089733300000/a903202310/lys/research/hallucination-detection/src/methods/haloscope.py", line 618, in extract_method_features
    if np.any(~np.isfinite(hidden_states)):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
Exception ignored in atexit callback: <function dump_compile_times at 0x7f99dec50180>
Traceback (most recent call last):
  File "/share/home/tm902089733300000/a903202310/lys/conda_envs/lapeigvals/lib/python3.12/site-packages/torch/_dynamo/utils.py", line 446, in dump_compile_times
    log.info(compile_times(repr="str", aggregate=True))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/share/home/tm902089733300000/a903202310/lys/conda_envs/lapeigvals/lib/python3.12/site-packages/torch/_dynamo/utils.py", line 432, in compile_times
    out += tabulate(rows, headers=("Function", "Runtimes (s)"))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/share/home/tm902089733300000/a903202310/lys/conda_envs/lapeigvals/lib/python3.12/site-packages/torch/_dynamo/utils.py", line 207, in tabulate
    import tabulate
  File "/share/home/tm902089733300000/a903202310/lys/conda_envs/lapeigvals/lib/python3.12/site-packages/tabulate/__init__.py", line 15, in <module>
    import wcwidth  # optional wide-character (CJK) support
    ^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap_external>", line 1091, in get_code
  File "<frozen importlib._bootstrap_external>", line 1190, in get_data
KeyboardInterrupt: 
