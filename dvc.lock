schema: '2.0'
stages:
  split_dataset:
    cmd: python scripts/split_dataset.py
    deps:
    - path: config/dataset/
      hash: md5
      md5: dd74d37725df99af70e8692b5a2a9568.dir
      size: 4574
      nfiles: 3
    - path: scripts/split_dataset.py
      hash: md5
      md5: 5dfcdc09ac10b6ef6a354b3e407e5013
      size: 13335
    params:
      params.yaml:
        datasets:
        - name: ragtruth
        seed: 42
        split:
          test_ratio: 0.1
          random_seed: 42
          stratify: true
    outs:
    - path: outputs/splits/
      hash: md5
      md5: 0d8169838d4d836682e422f2a7093812.dir
      size: 71823041
      nfiles: 3
  generate_activations@dataset0-QA-model0:
    cmd: CUDA_VISIBLE_DEVICES=0,1 python scripts/generate_activations.py 
      dataset.name=ragtruth dataset.task_type=QA dataset.split_name=train 
      model=llama2_7b_chat model.short_name=Llama-2-7b-chat-hf 
      features.mode=teacher_forcing features.max_length=10000 
      features.batch_size=4 seed=42 
      methods=[lapeigvals,lookback_lens,haloscope,hsdmvaf,hypergraph,semantic_entropy_probes,tsv]
      allow_full_attention=true
    deps:
    - path: config/
      hash: md5
      md5: 8b11690bf245f11c680c2c78bbf2de5a.dir
      size: 69193
      nfiles: 39
    - path: outputs/splits/
      hash: md5
      md5: 0d8169838d4d836682e422f2a7093812.dir
      size: 71823041
      nfiles: 3
    - path: scripts/generate_activations.py
      hash: md5
      md5: 1d70bd3307007eba1e83376840208a0a
      size: 6848
    - path: src/
      hash: md5
      md5: 549e48e1cbfd5705fb0ff77289e081d7.dir
      size: 1308002
      nfiles: 112
    - path: utils/
      hash: md5
      md5: 34876b4220264e295e9c9a54aefda19c.dir
      size: 106648
      nfiles: 8
    params:
      params.yaml:
        features.batch_size: 4
        features.max_length: 10000
        features.mode: teacher_forcing
        methods:
        - lapeigvals
        - lookback_lens
        - haloscope
        - hsdmvaf
        - semantic_entropy_probes
        - tsv
        - hypergraph
        seed: 42
    outs:
    - path: outputs/features/ragtruth/Llama-2-7b-chat-hf/seed_42/QA/
      hash: md5
      md5: 8c5f03e65d18b838799dbb810e5f0f73.dir
      size: 747667924296
      nfiles: 815
  generate_activations@dataset0-Summary-model0:
    cmd: CUDA_VISIBLE_DEVICES=0,1 python scripts/generate_activations.py 
      dataset.name=ragtruth dataset.task_type=Summary dataset.split_name=train 
      model=llama2_7b_chat model.short_name=Llama-2-7b-chat-hf 
      features.mode=teacher_forcing features.max_length=10000 
      features.batch_size=4 seed=42 
      methods=[lapeigvals,lookback_lens,haloscope,hsdmvaf,hypergraph,semantic_entropy_probes,tsv]
      allow_full_attention=true
    deps:
    - path: config/
      hash: md5
      md5: 8b11690bf245f11c680c2c78bbf2de5a.dir
      size: 69193
      nfiles: 39
    - path: outputs/splits/
      hash: md5
      md5: 0d8169838d4d836682e422f2a7093812.dir
      size: 71823041
      nfiles: 3
    - path: scripts/generate_activations.py
      hash: md5
      md5: 1d70bd3307007eba1e83376840208a0a
      size: 6848
    - path: src/
      hash: md5
      md5: 549e48e1cbfd5705fb0ff77289e081d7.dir
      size: 1308002
      nfiles: 112
    - path: utils/
      hash: md5
      md5: 34876b4220264e295e9c9a54aefda19c.dir
      size: 106648
      nfiles: 8
    params:
      params.yaml:
        features.batch_size: 4
        features.max_length: 10000
        features.mode: teacher_forcing
        methods:
        - lapeigvals
        - lookback_lens
        - haloscope
        - hsdmvaf
        - semantic_entropy_probes
        - tsv
        - hypergraph
        seed: 42
    outs:
    - path: outputs/features/ragtruth/Llama-2-7b-chat-hf/seed_42/Summary/
      hash: md5
      md5: 531ee70f18dfa11cf07b9bca81d6f8c7.dir
      size: 2272053256555
      nfiles: 802
  generate_activations@dataset0-Data2txt-model0:
    cmd: CUDA_VISIBLE_DEVICES=0,1 python scripts/generate_activations.py 
      dataset.name=ragtruth dataset.task_type=Data2txt dataset.split_name=train 
      model=llama2_7b_chat model.short_name=Llama-2-7b-chat-hf 
      features.mode=teacher_forcing features.max_length=10000 
      features.batch_size=4 seed=42 
      methods=[lapeigvals,lookback_lens,haloscope,hsdmvaf,hypergraph,semantic_entropy_probes,tsv]
      allow_full_attention=true
    deps:
    - path: config/
      hash: md5
      md5: 8b11690bf245f11c680c2c78bbf2de5a.dir
      size: 69193
      nfiles: 39
    - path: outputs/splits/
      hash: md5
      md5: 0d8169838d4d836682e422f2a7093812.dir
      size: 71823041
      nfiles: 3
    - path: scripts/generate_activations.py
      hash: md5
      md5: 1d70bd3307007eba1e83376840208a0a
      size: 6848
    - path: src/
      hash: md5
      md5: 549e48e1cbfd5705fb0ff77289e081d7.dir
      size: 1308002
      nfiles: 112
    - path: utils/
      hash: md5
      md5: 34876b4220264e295e9c9a54aefda19c.dir
      size: 106648
      nfiles: 8
    params:
      params.yaml:
        features.batch_size: 4
        features.max_length: 10000
        features.mode: teacher_forcing
        methods:
        - lapeigvals
        - lookback_lens
        - haloscope
        - hsdmvaf
        - semantic_entropy_probes
        - tsv
        - hypergraph
        seed: 42
    outs:
    - path: outputs/features/ragtruth/Llama-2-7b-chat-hf/seed_42/Data2txt/
      hash: md5
      md5: 8eb170516cf81602964766b0217862e2.dir
      size: 2534898934886
      nfiles: 894
  generate_activations_test@dataset0-QA-model0:
    cmd: CUDA_VISIBLE_DEVICES=0,1 python scripts/generate_activations.py 
      dataset.name=ragtruth dataset.task_type=QA dataset.split_name=test 
      model=llama2_7b_chat model.short_name=Llama-2-7b-chat-hf 
      features.mode=teacher_forcing features.max_length=10000 
      features.batch_size=4 seed=42 
      methods=[lapeigvals,lookback_lens,haloscope,hsdmvaf,hypergraph,semantic_entropy_probes,tsv]
      allow_full_attention=true
    deps:
    - path: config/
      hash: md5
      md5: 8b11690bf245f11c680c2c78bbf2de5a.dir
      size: 69193
      nfiles: 39
    - path: outputs/splits/
      hash: md5
      md5: 0d8169838d4d836682e422f2a7093812.dir
      size: 71823041
      nfiles: 3
    - path: scripts/generate_activations.py
      hash: md5
      md5: 1d70bd3307007eba1e83376840208a0a
      size: 6848
    - path: src/
      hash: md5
      md5: 391683a4fa9dfdf20070866118e57c30.dir
      size: 1329517
      nfiles: 113
    - path: utils/
      hash: md5
      md5: 34876b4220264e295e9c9a54aefda19c.dir
      size: 106648
      nfiles: 8
    params:
      params.yaml:
        features.batch_size: 4
        features.max_length: 10000
        features.mode: teacher_forcing
        methods:
        - lapeigvals
        - lookback_lens
        - haloscope
        - hsdmvaf
        - semantic_entropy_probes
        - tsv
        - hypergraph
        seed: 42
    outs:
    - path: outputs/features/ragtruth/Llama-2-7b-chat-hf/seed_42/QA_test/
      hash: md5
      md5: 756864077f1e36e949708902539436d1.dir
      size: 119901490523
      nfiles: 148
  generate_activations_test@dataset0-Summary-model0:
    cmd: CUDA_VISIBLE_DEVICES=0,1 python scripts/generate_activations.py 
      dataset.name=ragtruth dataset.task_type=Summary dataset.split_name=test 
      model=llama2_7b_chat model.short_name=Llama-2-7b-chat-hf 
      features.mode=teacher_forcing features.max_length=10000 
      features.batch_size=4 seed=42 
      methods=[lapeigvals,lookback_lens,haloscope,hsdmvaf,hypergraph,semantic_entropy_probes,tsv]
      allow_full_attention=true
    deps:
    - path: config/
      hash: md5
      md5: 8b11690bf245f11c680c2c78bbf2de5a.dir
      size: 69193
      nfiles: 39
    - path: outputs/splits/
      hash: md5
      md5: 0d8169838d4d836682e422f2a7093812.dir
      size: 71823041
      nfiles: 3
    - path: scripts/generate_activations.py
      hash: md5
      md5: 1d70bd3307007eba1e83376840208a0a
      size: 6848
    - path: src/
      hash: md5
      md5: 057339e679670f8dc7aa09021261c523.dir
      size: 1329517
      nfiles: 113
    - path: utils/
      hash: md5
      md5: 34876b4220264e295e9c9a54aefda19c.dir
      size: 106648
      nfiles: 8
    params:
      params.yaml:
        features.batch_size: 4
        features.max_length: 10000
        features.mode: teacher_forcing
        methods:
        - lapeigvals
        - lookback_lens
        - haloscope
        - hsdmvaf
        - semantic_entropy_probes
        - tsv
        - hypergraph
        seed: 42
    outs:
    - path: outputs/features/ragtruth/Llama-2-7b-chat-hf/seed_42/Summary_test/
      hash: md5
      md5: dabf3a6e27cb6427e582a42442839d66.dir
      size: 411313583743
      nfiles: 162
  generate_activations_test@dataset0-Data2txt-model0:
    cmd: CUDA_VISIBLE_DEVICES=0,1 python scripts/generate_activations.py 
      dataset.name=ragtruth dataset.task_type=Data2txt dataset.split_name=test 
      model=llama2_7b_chat model.short_name=Llama-2-7b-chat-hf 
      features.mode=teacher_forcing features.max_length=10000 
      features.batch_size=4 seed=42 
      methods=[lapeigvals,lookback_lens,haloscope,hsdmvaf,hypergraph,semantic_entropy_probes,tsv]
      allow_full_attention=true
    deps:
    - path: config/
      hash: md5
      md5: 8b11690bf245f11c680c2c78bbf2de5a.dir
      size: 69193
      nfiles: 39
    - path: outputs/splits/
      hash: md5
      md5: 0d8169838d4d836682e422f2a7093812.dir
      size: 71823041
      nfiles: 3
    - path: scripts/generate_activations.py
      hash: md5
      md5: 1d70bd3307007eba1e83376840208a0a
      size: 6848
    - path: src/
      hash: md5
      md5: 057339e679670f8dc7aa09021261c523.dir
      size: 1329517
      nfiles: 113
    - path: utils/
      hash: md5
      md5: 34876b4220264e295e9c9a54aefda19c.dir
      size: 106648
      nfiles: 8
    params:
      params.yaml:
        features.batch_size: 4
        features.max_length: 10000
        features.mode: teacher_forcing
        methods:
        - lapeigvals
        - lookback_lens
        - haloscope
        - hsdmvaf
        - semantic_entropy_probes
        - tsv
        - hypergraph
        seed: 42
    outs:
    - path: outputs/features/ragtruth/Llama-2-7b-chat-hf/seed_42/Data2txt_test/
      hash: md5
      md5: c63d8a765390ae4757d776ca67ac28f6.dir
      size: 437530801173
      nfiles: 162
